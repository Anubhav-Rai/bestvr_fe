{"ast":null,"code":"import _objectSpread from\"/Users/anubhavrai/Anubhav-Rai/bestvragro_fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import Header from'./components/Header';import Navigation from'./components/Navigation';import ProductCard from'./components/ProductCard';import LoginForm from'./components/LoginForm';import RegisterForm from'./components/RegisterForm';import CartView from'./components/CartView';import OrdersView from'./components/OrdersView';import WishlistView from'./components/WishlistView';import ProfileView from'./components/ProfileView';import CompanyInfo from'./components/CompanyInfo';import AboutUs from'./components/AboutUs';import ContactUs from'./components/ContactUs';import{Package,Info,Phone}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const normalizeOrders=data=>{return Array.isArray(data)?data.map(order=>_objectSpread(_objectSpread({},order),{},{userId:order.userid||order.userId,items:Array.isArray(order.items)?order.items.map(item=>_objectSpread(_objectSpread({},item),{},{productId:item.productid||item.productId})):[]})):[];};const TeakSpiceStore=()=>{// App state\nconst[user,setUser]=useState(null);const[currentView,setCurrentView]=useState('home');const[products,setProducts]=useState([]);// always an array!\nconst[cart,setCart]=useState([]);const[orders,setOrders]=useState([]);const[wishlist,setWishlist]=useState([]);const[address,setAddress]=useState({});const[loading,setLoading]=useState(false);const[darkMode,setDarkMode]=useState(()=>{// Check localStorage first, then system preference\nconst saved=localStorage.getItem('darkMode');if(saved!==null)return JSON.parse(saved);return window.matchMedia('(prefers-color-scheme: dark)').matches;});// JWT Helper\nconst getToken=()=>localStorage.getItem('token');const authHeader=()=>({Authorization:\"Bearer \".concat(getToken())});// Fetch products on mount\nuseEffect(()=>{fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/products\")).then(res=>res.json()).then(data=>setProducts(Array.isArray(data)?data:[])).catch(err=>{console.error('Failed to fetch products:',err);setProducts([]);});},[]);// Try auto-login on mount\nuseEffect(()=>{const token=getToken();if(token){fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/user/profile\"),{headers:authHeader()}).then(res=>res.ok?res.json():null).then(u=>{if(u)setUser(u);}).catch(()=>{});}},[]);// Fetch user-specific data after login\nuseEffect(()=>{if(user){fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setCart(Array.isArray(data.items)?data.items:[]));fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/wishlist\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setWishlist(Array.isArray(data.productIds)?data.productIds:[]));fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/orders\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setOrders(normalizeOrders(data)));}else{setCart([]);setWishlist([]);setOrders([]);}},[user]);// --- Auth Handlers (REAL) ---\nconst handleLogin=async(email,password)=>{if(!email||!password)return alert('Please fill all fields');setLoading(true);try{const res=await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/login\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password})});if(!res.ok){alert('Login failed');setLoading(false);return;}const result=await res.json();setUser(result.user);localStorage.setItem('token',result.token);setCurrentView('home');}catch(e){alert('Login error');}setLoading(false);};const handleRegister=async _ref=>{let{name,email,phone,password}=_ref;if(!name||!email||!phone||!password)return alert('Please fill all fields');setLoading(true);try{const res=await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/register\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,email,phone,password})});if(!res.ok){alert('Registration failed');setLoading(false);return;}// Auto-login after register\nawait handleLogin(email,password);}catch(e){alert('Registration error');}setLoading(false);};const handleLogout=()=>{setUser(null);setCart([]);setOrders([]);setWishlist([]);localStorage.removeItem('token');setCurrentView('home');};// --- Cart Handlers ---\nconst addToCart=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(!user){setCurrentView('login');return;}// Check stock availability before adding to cart\nconst product=products.find(p=>String(p.id)===String(productId)||String(p._id)===String(productId));const availableStock=product?product.stock||0:0;// Get current quantity in cart for this product\nconst currentCartItem=cart.find(item=>String(item.productId)===String(productId)||String(item.id)===String(productId));const currentQuantityInCart=currentCartItem?currentCartItem.quantity:0;if(availableStock<=0){alert('This product is out of stock');return;}if(currentQuantityInCart+quantity>availableStock){alert(\"Only \".concat(availableStock,\" items available. You already have \").concat(currentQuantityInCart,\" in your cart.\"));return;}try{await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart\"),{method:'POST',headers:_objectSpread(_objectSpread({},authHeader()),{},{'Content-Type':'application/json'}),body:JSON.stringify({productId,quantity})});// Refresh cart\nfetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setCart(Array.isArray(data.items)?data.items:[]));}catch(error){console.error('Error adding to cart:',error);alert('Failed to add item to cart');}};const removeFromCart=async productId=>{await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart/\").concat(productId),{method:'DELETE',headers:authHeader()});fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setCart(Array.isArray(data.items)?data.items:[]));};const updateCartQuantity=async(productId,newQuantity)=>{if(newQuantity<=0){await removeFromCart(productId);return;}// Check stock availability before updating quantity\nconst product=products.find(p=>String(p.id)===String(productId)||String(p._id)===String(productId));const availableStock=product?product.stock||0:0;if(newQuantity>availableStock){alert(\"Only \".concat(availableStock,\" items available in stock\"));return;}try{await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart/\").concat(productId),{method:'PUT',headers:_objectSpread(_objectSpread({},authHeader()),{},{'Content-Type':'application/json'}),body:JSON.stringify({quantity:newQuantity})});fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/cart\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setCart(Array.isArray(data.items)?data.items:[]));}catch(error){console.error('Error updating cart quantity:',error);alert('Failed to update cart quantity');}};const getCartTotal=()=>{return cart.reduce((total,item)=>{const productId=item.productId||item.id;const prod=products.find(p=>String(p.id)===String(productId)||String(p._id)===String(productId));const itemTotal=prod?prod.price*item.quantity:0;return total+itemTotal;},0);};const getCartCount=()=>cart.reduce((count,item)=>count+item.quantity,0);// --- Wishlist Handlers ---\nconst toggleWishlist=async productId=>{if(!user){setCurrentView('login');return;}if(wishlist.includes(productId)){await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/wishlist/\").concat(productId),{method:'DELETE',headers:authHeader()});}else{await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/wishlist\"),{method:'POST',headers:_objectSpread(_objectSpread({},authHeader()),{},{'Content-Type':'application/json'}),body:JSON.stringify({productId})});}fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/wishlist\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setWishlist(Array.isArray(data.productIds)?data.productIds:[]));};// --- Order Handler ---\nconst placeOrder=async()=>{// Validate required address fields\nif(!address.fullName||!address.phone||!address.street||!address.city||!address.postalCode||!address.country){return alert('Please fill in all required address fields');}if(cart.length===0){return alert('Your cart is empty');}try{// Step 1: Final stock validation before placing order\nconst stockValidation=[];for(const item of cart){const productId=item.productId||item.id;const product=products.find(p=>String(p.id)===String(productId)||String(p._id)===String(productId));const availableStock=product?product.stock||0:0;if(availableStock<item.quantity){stockValidation.push({productName:product?product.name:\"Product \".concat(productId),requested:item.quantity,available:availableStock});}}// If any items don't have sufficient stock, show error and abort\nif(stockValidation.length>0){const errorMessage=stockValidation.map(item=>\"\".concat(item.productName,\": requested \").concat(item.requested,\", only \").concat(item.available,\" available\")).join('\\n');alert(\"Insufficient stock for the following items:\\n\\n\".concat(errorMessage,\"\\n\\nPlease update your cart quantities.\"));return;}const orderItems=cart.map(item=>({productId:item.productId||item.id,quantity:item.quantity}));// Convert structured address to string format for backend compatibility\nconst addressString=\"\".concat(address.fullName,\"\\n\").concat(address.phone,\"\\n\").concat(address.street,\"\\n\").concat(address.city).concat(address.state?', '+address.state:'',\" \").concat(address.postalCode,\"\\n\").concat(address.country).concat(address.instructions?'\\n\\nInstructions: '+address.instructions:'');// Step 2: Place the order\nconst orderRes=await fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/orders\"),{method:'POST',headers:_objectSpread(_objectSpread({},authHeader()),{},{'Content-Type':'application/json'}),body:JSON.stringify({address:addressString,items:orderItems,total:getCartTotal(),stockValidation:true// Flag to backend to handle stock deduction\n})});if(!orderRes.ok){const errorData=await orderRes.json().catch(()=>({}));if(orderRes.status===409){// Conflict - insufficient stock\nalert('Order failed: Some items are no longer available in the requested quantities. Please refresh and try again.');}else{alert(\"Order failed: \".concat(errorData.message||'Unknown error'));}return;}// Step 3: If order successful, update stock locally for immediate UI feedback\n// This will be synced with backend on next product fetch\nconst updatedProducts=products.map(product=>{const orderItem=cart.find(item=>String(item.productId)===String(product.id)||String(item.productId)===String(product._id)||String(item.id)===String(product.id)||String(item.id)===String(product._id));if(orderItem){return _objectSpread(_objectSpread({},product),{},{stock:Math.max(0,(product.stock||0)-orderItem.quantity)});}return product;});setProducts(updatedProducts);// Step 4: Refresh orders and clear cart\nfetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/orders\"),{headers:authHeader()}).then(res=>res.json()).then(data=>setOrders(normalizeOrders(data)));setCart([]);setAddress({});alert('Order placed successfully! Stock has been updated.');setCurrentView('orders');// Step 5: Refresh products from backend to sync stock\nsetTimeout(()=>{fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/products\")).then(res=>res.json()).then(data=>setProducts(Array.isArray(data)?data:[])).catch(err=>console.error('Failed to refresh products:',err));},1000);}catch(error){console.error('Order placement error:',error);alert('Order failed due to a network error. Please try again.');}};// --- Dark mode handler ---\nconst toggleDarkMode=()=>{const newDarkMode=!darkMode;setDarkMode(newDarkMode);localStorage.setItem('darkMode',JSON.stringify(newDarkMode));};// --- Navigation handler ---\nconst handleNav=view=>setCurrentView(view);// --- Rendering ---\nconsole.log(\"TeakSpiceStore: orders state\",orders);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen transition-all duration-700 relative \".concat(darkMode?'bg-black':'bg-white'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 overflow-hidden pointer-events-none\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"absolute inset-0 w-full h-full opacity-5\",viewBox:\"0 0 100 100\",children:[/*#__PURE__*/_jsx(\"defs\",{children:/*#__PURE__*/_jsx(\"pattern\",{id:\"grid\",width:\"10\",height:\"10\",patternUnits:\"userSpaceOnUse\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M 10 0 L 0 0 0 10\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"0.5\"})})}),/*#__PURE__*/_jsx(\"rect\",{width:\"100\",height:\"100\",fill:\"url(#grid)\",className:darkMode?'text-white':'text-slate-900'})]})}),/*#__PURE__*/_jsx(Header,{user:user,cartCount:getCartCount(),onLogout:handleLogout,onNav:handleNav,onLogin:()=>setCurrentView('login'),onRegister:()=>setCurrentView('register'),darkMode:darkMode,toggleDarkMode:toggleDarkMode}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row\",children:[user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"aside\",{className:\"hidden lg:block w-64 shadow-sm border-r min-h-screen sticky top-24 pt-16 transition-all duration-300 z-10 backdrop-blur-sm border-white/10\",children:/*#__PURE__*/_jsx(Navigation,{user:user,currentView:currentView,onNav:handleNav,darkMode:darkMode})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:hidden fixed bottom-0 left-0 right-0 z-30 border-t transition-all duration-300 backdrop-blur-sm border-white/10\",children:/*#__PURE__*/_jsx(Navigation,{user:user,currentView:currentView,onNav:handleNav,darkMode:darkMode,isMobile:true})})]}),!user&&/*#__PURE__*/_jsx(\"div\",{className:\"lg:hidden fixed bottom-0 left-0 right-0 z-30 border-t transition-all duration-300 backdrop-blur-sm border-white/10\",children:/*#__PURE__*/_jsx(\"nav\",{className:\"p-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-around items-center\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleNav('home'),className:\"flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 \".concat(currentView==='home'?darkMode?'text-emerald-400':'text-emerald-600':darkMode?'text-slate-400 hover:text-white':'text-slate-500 hover:text-slate-900'),children:[/*#__PURE__*/_jsx(Package,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium\",children:\"Products\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleNav('about'),className:\"flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 \".concat(currentView==='about'?darkMode?'text-emerald-400':'text-emerald-600':darkMode?'text-slate-400 hover:text-white':'text-slate-500 hover:text-slate-900'),children:[/*#__PURE__*/_jsx(Info,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium\",children:\"About\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleNav('contact'),className:\"flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 \".concat(currentView==='contact'?darkMode?'text-emerald-400':'text-emerald-600':darkMode?'text-slate-400 hover:text-white':'text-slate-500 hover:text-slate-900'),children:[/*#__PURE__*/_jsx(Phone,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium\",children:\"Contact\"})]})]})})}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-1 px-6 lg:px-12 pt-28 pb-32 relative z-10 \".concat(user?'max-w-none':'max-w-none'),children:[currentView==='home'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-20\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"text-center space-y-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-5xl lg:text-7xl font-black tracking-tight transition-all duration-700 \".concat(darkMode?'text-white':'text-black'),children:[\"Premium\",/*#__PURE__*/_jsx(\"span\",{className:\"block bg-gradient-to-r from-emerald-500 to-teal-600 bg-clip-text text-transparent\",children:\"Kitchen Essentials\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl lg:text-2xl max-w-3xl mx-auto leading-relaxed \".concat(darkMode?'text-white/70':'text-black/70'),children:\"Discover handcrafted teak wood products and premium spices that transform your cooking experience\"})]})}),/*#__PURE__*/_jsxs(\"section\",{className:\"space-y-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-4xl font-black transition-all duration-300 \".concat(darkMode?'text-white':'text-black'),children:\"Our Collection\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4 px-6 py-3 rounded-2xl backdrop-blur-xl border transition-all duration-500 \".concat(darkMode?'bg-white/5 border-white/10 text-white/60':'bg-black/5 border-black/10 text-black/60'),children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-semibold\",children:[Array.isArray(products)?products.length:0,\" Products Available\"]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 lg:gap-12\",children:Array.isArray(products)&&products.length>0?products.map(product=>/*#__PURE__*/_jsx(ProductCard,{product:product,user:user,wishlist:wishlist,cart:cart,onAddToCart:addToCart,onToggleWishlist:toggleWishlist,onUpdateQuantity:updateCartQuantity,onRemoveFromCart:removeFromCart,darkMode:darkMode},product.id||product._id)):/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full flex flex-col items-center justify-center py-16\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-2 transition-colors duration-300 \".concat(darkMode?'text-white':'text-slate-900'),children:\"No products available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"transition-colors duration-300 \".concat(darkMode?'text-slate-300':'text-slate-600'),children:\"Check back later for new arrivals.\"})]})})]})]}),currentView==='login'&&/*#__PURE__*/_jsx(LoginForm,{onLogin:handleLogin,onSwitchToRegister:()=>setCurrentView('register'),loading:loading,darkMode:darkMode}),currentView==='register'&&/*#__PURE__*/_jsx(RegisterForm,{onRegister:handleRegister,onSwitchToLogin:()=>setCurrentView('login'),loading:loading,darkMode:darkMode}),currentView==='cart'&&/*#__PURE__*/_jsx(CartView,{cart:cart,user:user,address:address,onUpdateAddress:setAddress,onPlaceOrder:placeOrder,onNav:handleNav,onUpdateQuantity:updateCartQuantity,onRemoveFromCart:removeFromCart,getCartTotal:getCartTotal,products:products,darkMode:darkMode}),currentView==='orders'&&user&&/*#__PURE__*/_jsx(OrdersView,{orders:orders,products:products,darkMode:darkMode}),currentView==='wishlist'&&user&&/*#__PURE__*/_jsx(WishlistView,{products:products,wishlist:wishlist,user:user,onAddToCart:addToCart,onToggleWishlist:toggleWishlist,darkMode:darkMode}),currentView==='profile'&&user&&/*#__PURE__*/_jsx(ProfileView,{user:user,darkMode:darkMode}),currentView==='about'&&/*#__PURE__*/_jsx(AboutUs,{darkMode:darkMode}),currentView==='contact'&&/*#__PURE__*/_jsx(ContactUs,{darkMode:darkMode})]})]})]});};export default TeakSpiceStore;","map":{"version":3,"names":["React","useState","useEffect","Header","Navigation","ProductCard","LoginForm","RegisterForm","CartView","OrdersView","WishlistView","ProfileView","CompanyInfo","AboutUs","ContactUs","Package","Info","Phone","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","normalizeOrders","data","Array","isArray","map","order","_objectSpread","userId","userid","items","item","productId","productid","TeakSpiceStore","user","setUser","currentView","setCurrentView","products","setProducts","cart","setCart","orders","setOrders","wishlist","setWishlist","address","setAddress","loading","setLoading","darkMode","setDarkMode","saved","localStorage","getItem","JSON","parse","window","matchMedia","matches","getToken","authHeader","Authorization","concat","fetch","process","env","REACT_APP_API_BASE_URL","then","res","json","catch","err","console","error","token","headers","ok","u","productIds","handleLogin","email","password","alert","method","body","stringify","result","setItem","e","handleRegister","_ref","name","phone","handleLogout","removeItem","addToCart","quantity","arguments","length","undefined","product","find","p","String","id","_id","availableStock","stock","currentCartItem","currentQuantityInCart","removeFromCart","updateCartQuantity","newQuantity","getCartTotal","reduce","total","prod","itemTotal","price","getCartCount","count","toggleWishlist","includes","placeOrder","fullName","street","city","postalCode","country","stockValidation","push","productName","requested","available","errorMessage","join","orderItems","addressString","state","instructions","orderRes","errorData","status","message","updatedProducts","orderItem","Math","max","setTimeout","toggleDarkMode","newDarkMode","handleNav","view","log","className","children","viewBox","width","height","patternUnits","d","fill","stroke","strokeWidth","cartCount","onLogout","onNav","onLogin","onRegister","isMobile","onClick","size","onAddToCart","onToggleWishlist","onUpdateQuantity","onRemoveFromCart","onSwitchToRegister","onSwitchToLogin","onUpdateAddress","onPlaceOrder"],"sources":["/Users/anubhavrai/Anubhav-Rai/bestvragro_fe/src/TeakSpiceStore.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Header from './components/Header';\nimport Navigation from './components/Navigation';\nimport ProductCard from './components/ProductCard';\nimport LoginForm from './components/LoginForm';\nimport RegisterForm from './components/RegisterForm';\nimport CartView from './components/CartView';\nimport OrdersView from './components/OrdersView';\nimport WishlistView from './components/WishlistView';\nimport ProfileView from './components/ProfileView';\nimport CompanyInfo from './components/CompanyInfo';\nimport AboutUs from './components/AboutUs';\nimport ContactUs from './components/ContactUs';\nimport { Package, Info, Phone } from 'lucide-react';\n\nconst normalizeOrders = (data) => {\n  return Array.isArray(data) ? data.map(order => ({\n    ...order,\n    userId: order.userid || order.userId,\n    items: Array.isArray(order.items) ? order.items.map(item => ({\n      ...item,\n      productId: item.productid || item.productId,\n    })) : [],\n  })) : [];\n};\n\n\nconst TeakSpiceStore = () => {\n  // App state\n  const [user, setUser] = useState(null);\n  const [currentView, setCurrentView] = useState('home');\n  const [products, setProducts] = useState([]); // always an array!\n  const [cart, setCart] = useState([]);\n  const [orders, setOrders] = useState([]);\n  const [wishlist, setWishlist] = useState([]);\n  const [address, setAddress] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [darkMode, setDarkMode] = useState(() => {\n    // Check localStorage first, then system preference\n    const saved = localStorage.getItem('darkMode');\n    if (saved !== null) return JSON.parse(saved);\n    return window.matchMedia('(prefers-color-scheme: dark)').matches;\n  });\n\n  // JWT Helper\n  const getToken = () => localStorage.getItem('token');\n  const authHeader = () => ({ Authorization: `Bearer ${getToken()}` });\n\n  // Fetch products on mount\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_API_BASE_URL}/api/products`)\n      .then(res => res.json())\n      .then(data => setProducts(Array.isArray(data) ? data : []))\n      .catch(err => {\n        console.error('Failed to fetch products:', err);\n        setProducts([]);\n      });\n  }, []);\n\n  // Try auto-login on mount\n  useEffect(() => {\n    const token = getToken();\n    if (token) {\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/user/profile`, { headers: authHeader() })\n        .then(res => res.ok ? res.json() : null)\n        .then(u => { if (u) setUser(u); })\n        .catch(() => {});\n    }\n  }, []);\n\n  // Fetch user-specific data after login\n  useEffect(() => {\n    if (user) {\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setCart(Array.isArray(data.items) ? data.items : []));\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/wishlist`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setWishlist(Array.isArray(data.productIds) ? data.productIds : []));\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/orders`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setOrders(normalizeOrders(data)));\n    } else {\n      setCart([]); setWishlist([]); setOrders([]);\n    }\n  }, [user]);\n\n  // --- Auth Handlers (REAL) ---\n  const handleLogin = async (email, password) => {\n    if (!email || !password) return alert('Please fill all fields');\n    setLoading(true);\n    try {\n      const res = await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password })\n      });\n      if (!res.ok) {\n        alert('Login failed');\n        setLoading(false);\n        return;\n      }\n      const result = await res.json();\n      setUser(result.user);\n      localStorage.setItem('token', result.token);\n      setCurrentView('home');\n    } catch (e) {\n      alert('Login error');\n    }\n    setLoading(false);\n  };\n\n  const handleRegister = async ({ name, email, phone, password }) => {\n    if (!name || !email || !phone || !password) return alert('Please fill all fields');\n    setLoading(true);\n    try {\n      const res = await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/register`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ name, email, phone, password })\n      });\n      if (!res.ok) {\n        alert('Registration failed');\n        setLoading(false);\n        return;\n      }\n      // Auto-login after register\n      await handleLogin(email, password);\n    } catch (e) {\n      alert('Registration error');\n    }\n    setLoading(false);\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    setCart([]);\n    setOrders([]);\n    setWishlist([]);\n    localStorage.removeItem('token');\n    setCurrentView('home');\n  };\n\n  // --- Cart Handlers ---\n  const addToCart = async (productId, quantity = 1) => {\n    if (!user) {\n      setCurrentView('login');\n      return;\n    }\n    \n    // Check stock availability before adding to cart\n    const product = products.find(p => String(p.id) === String(productId) || String(p._id) === String(productId));\n    const availableStock = product ? product.stock || 0 : 0;\n    \n    // Get current quantity in cart for this product\n    const currentCartItem = cart.find(item => \n      String(item.productId) === String(productId) || String(item.id) === String(productId)\n    );\n    const currentQuantityInCart = currentCartItem ? currentCartItem.quantity : 0;\n    \n    if (availableStock <= 0) {\n      alert('This product is out of stock');\n      return;\n    }\n    \n    if (currentQuantityInCart + quantity > availableStock) {\n      alert(`Only ${availableStock} items available. You already have ${currentQuantityInCart} in your cart.`);\n      return;\n    }\n    \n    try {\n      await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart`, {\n        method: 'POST',\n        headers: { ...authHeader(), 'Content-Type': 'application/json' },\n        body: JSON.stringify({ productId, quantity })\n      });\n      \n      // Refresh cart\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setCart(Array.isArray(data.items) ? data.items : []));\n    } catch (error) {\n      console.error('Error adding to cart:', error);\n      alert('Failed to add item to cart');\n    }\n  };\n\n  const removeFromCart = async (productId) => {\n    await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart/${productId}`, {\n      method: 'DELETE',\n      headers: authHeader()\n    });\n    fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart`, { headers: authHeader() })\n      .then(res => res.json()).then(data => setCart(Array.isArray(data.items) ? data.items : []));\n  };\n\n  const updateCartQuantity = async (productId, newQuantity) => {\n    if (newQuantity <= 0) {\n      await removeFromCart(productId);\n      return;\n    }\n    \n    // Check stock availability before updating quantity\n    const product = products.find(p => String(p.id) === String(productId) || String(p._id) === String(productId));\n    const availableStock = product ? product.stock || 0 : 0;\n    \n    if (newQuantity > availableStock) {\n      alert(`Only ${availableStock} items available in stock`);\n      return;\n    }\n    \n    try {\n      await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart/${productId}`, {\n        method: 'PUT',\n        headers: { ...authHeader(), 'Content-Type': 'application/json' },\n        body: JSON.stringify({ quantity: newQuantity })\n      });\n      \n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/cart`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setCart(Array.isArray(data.items) ? data.items : []));\n    } catch (error) {\n      console.error('Error updating cart quantity:', error);\n      alert('Failed to update cart quantity');\n    }\n  };\n\n  const getCartTotal = () => {\n    return cart.reduce((total, item) => {\n      const productId = item.productId || item.id;\n      const prod = products.find(\n        p => String(p.id) === String(productId) || String(p._id) === String(productId)\n      );\n      \n      const itemTotal = prod ? prod.price * item.quantity : 0;\n      return total + itemTotal;\n    }, 0);\n  };\n\n  const getCartCount = () => cart.reduce((count, item) => count + item.quantity, 0);\n\n  // --- Wishlist Handlers ---\n  const toggleWishlist = async (productId) => {\n    if (!user) {\n      setCurrentView('login');\n      return;\n    }\n    if (wishlist.includes(productId)) {\n      await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/wishlist/${productId}`, { method: 'DELETE', headers: authHeader() });\n    } else {\n      await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/wishlist`, {\n        method: 'POST',\n        headers: { ...authHeader(), 'Content-Type': 'application/json' },\n        body: JSON.stringify({ productId })\n      });\n    }\n    fetch(`${process.env.REACT_APP_API_BASE_URL}/api/wishlist`, { headers: authHeader() })\n      .then(res => res.json()).then(data => setWishlist(Array.isArray(data.productIds) ? data.productIds : []));\n  };\n\n  // --- Order Handler ---\n  const placeOrder = async () => {\n    // Validate required address fields\n    if (!address.fullName || !address.phone || !address.street || !address.city || !address.postalCode || !address.country) {\n      return alert('Please fill in all required address fields');\n    }\n    \n    if (cart.length === 0) {\n      return alert('Your cart is empty');\n    }\n    \n    try {\n      // Step 1: Final stock validation before placing order\n      const stockValidation = [];\n      for (const item of cart) {\n        const productId = item.productId || item.id;\n        const product = products.find(p => String(p.id) === String(productId) || String(p._id) === String(productId));\n        const availableStock = product ? product.stock || 0 : 0;\n        \n        if (availableStock < item.quantity) {\n          stockValidation.push({\n            productName: product ? product.name : `Product ${productId}`,\n            requested: item.quantity,\n            available: availableStock\n          });\n        }\n      }\n      \n      // If any items don't have sufficient stock, show error and abort\n      if (stockValidation.length > 0) {\n        const errorMessage = stockValidation.map(item => \n          `${item.productName}: requested ${item.requested}, only ${item.available} available`\n        ).join('\\n');\n        alert(`Insufficient stock for the following items:\\n\\n${errorMessage}\\n\\nPlease update your cart quantities.`);\n        return;\n      }\n      \n      const orderItems = cart.map(item => ({\n        productId: item.productId || item.id,\n        quantity: item.quantity\n      }));\n      \n      // Convert structured address to string format for backend compatibility\n      const addressString = `${address.fullName}\\n${address.phone}\\n${address.street}\\n${address.city}${address.state ? ', ' + address.state : ''} ${address.postalCode}\\n${address.country}${address.instructions ? '\\n\\nInstructions: ' + address.instructions : ''}`;\n      \n      // Step 2: Place the order\n      const orderRes = await fetch(`${process.env.REACT_APP_API_BASE_URL}/api/orders`, {\n        method: 'POST',\n        headers: { ...authHeader(), 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          address: addressString, \n          items: orderItems,\n          total: getCartTotal(),\n          stockValidation: true // Flag to backend to handle stock deduction\n        })\n      });\n      \n      if (!orderRes.ok) {\n        const errorData = await orderRes.json().catch(() => ({}));\n        if (orderRes.status === 409) { // Conflict - insufficient stock\n          alert('Order failed: Some items are no longer available in the requested quantities. Please refresh and try again.');\n        } else {\n          alert(`Order failed: ${errorData.message || 'Unknown error'}`);\n        }\n        return;\n      }\n      \n      // Step 3: If order successful, update stock locally for immediate UI feedback\n      // This will be synced with backend on next product fetch\n      const updatedProducts = products.map(product => {\n        const orderItem = cart.find(item => \n          String(item.productId) === String(product.id) || \n          String(item.productId) === String(product._id) ||\n          String(item.id) === String(product.id) || \n          String(item.id) === String(product._id)\n        );\n        \n        if (orderItem) {\n          return {\n            ...product,\n            stock: Math.max(0, (product.stock || 0) - orderItem.quantity)\n          };\n        }\n        return product;\n      });\n      \n      setProducts(updatedProducts);\n      \n      // Step 4: Refresh orders and clear cart\n      fetch(`${process.env.REACT_APP_API_BASE_URL}/api/orders`, { headers: authHeader() })\n        .then(res => res.json()).then(data => setOrders(normalizeOrders(data)));\n      \n      setCart([]);\n      setAddress({});\n      alert('Order placed successfully! Stock has been updated.');\n      setCurrentView('orders');\n      \n      // Step 5: Refresh products from backend to sync stock\n      setTimeout(() => {\n        fetch(`${process.env.REACT_APP_API_BASE_URL}/api/products`)\n          .then(res => res.json())\n          .then(data => setProducts(Array.isArray(data) ? data : []))\n          .catch(err => console.error('Failed to refresh products:', err));\n      }, 1000);\n      \n    } catch (error) {\n      console.error('Order placement error:', error);\n      alert('Order failed due to a network error. Please try again.');\n    }\n  };\n\n  // --- Dark mode handler ---\n  const toggleDarkMode = () => {\n    const newDarkMode = !darkMode;\n    setDarkMode(newDarkMode);\n    localStorage.setItem('darkMode', JSON.stringify(newDarkMode));\n  };\n\n  // --- Navigation handler ---\n  const handleNav = (view) => setCurrentView(view);\n\n  // --- Rendering ---\n  console.log(\"TeakSpiceStore: orders state\", orders);\n  return (\n    <div className={`min-h-screen transition-all duration-700 relative ${darkMode ? 'bg-black' : 'bg-white'}`}>\n      {/* Modern geometric background */}\n      <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\n        <svg className=\"absolute inset-0 w-full h-full opacity-5\" viewBox=\"0 0 100 100\">\n          <defs>\n            <pattern id=\"grid\" width=\"10\" height=\"10\" patternUnits=\"userSpaceOnUse\">\n              <path d=\"M 10 0 L 0 0 0 10\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"0.5\"/>\n            </pattern>\n          </defs>\n          <rect width=\"100\" height=\"100\" fill=\"url(#grid)\" className={darkMode ? 'text-white' : 'text-slate-900'} />\n        </svg>\n        \n      </div>\n      <Header\n        user={user}\n        cartCount={getCartCount()}\n        onLogout={handleLogout}\n        onNav={handleNav}\n        onLogin={() => setCurrentView('login')}\n        onRegister={() => setCurrentView('register')}\n        darkMode={darkMode}\n        toggleDarkMode={toggleDarkMode}\n      />\n      \n      <div className=\"flex flex-col lg:flex-row\">\n        {/* Sidebar Navigation - Desktop */}\n        {user && (\n          <>\n            {/* Desktop Sidebar */}\n            <aside className=\"hidden lg:block w-64 shadow-sm border-r min-h-screen sticky top-24 pt-16 transition-all duration-300 z-10 backdrop-blur-sm border-white/10\">\n              <Navigation user={user} currentView={currentView} onNav={handleNav} darkMode={darkMode} />\n            </aside>\n            \n            {/* Mobile Bottom Navigation */}\n            <div className=\"lg:hidden fixed bottom-0 left-0 right-0 z-30 border-t transition-all duration-300 backdrop-blur-sm border-white/10\">\n              <Navigation user={user} currentView={currentView} onNav={handleNav} darkMode={darkMode} isMobile={true} />\n            </div>\n          </>\n        )}\n        \n        {/* Mobile Navigation for Non-logged-in users */}\n        {!user && (\n          <div className=\"lg:hidden fixed bottom-0 left-0 right-0 z-30 border-t transition-all duration-300 backdrop-blur-sm border-white/10\">\n            <nav className=\"p-2\">\n              <div className=\"flex justify-around items-center\">\n                <button \n                  onClick={() => handleNav('home')} \n                  className={`flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 ${\n                    currentView === 'home' \n                      ? darkMode \n                        ? 'text-emerald-400' \n                        : 'text-emerald-600'\n                      : darkMode \n                        ? 'text-slate-400 hover:text-white' \n                        : 'text-slate-500 hover:text-slate-900'\n                  }`}\n                >\n                  <Package size={16} />\n                  <span className=\"text-xs font-medium\">Products</span>\n                </button>\n                \n                <button \n                  onClick={() => handleNav('about')} \n                  className={`flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 ${\n                    currentView === 'about' \n                      ? darkMode \n                        ? 'text-emerald-400' \n                        : 'text-emerald-600'\n                      : darkMode \n                        ? 'text-slate-400 hover:text-white' \n                        : 'text-slate-500 hover:text-slate-900'\n                  }`}\n                >\n                  <Info size={16} />\n                  <span className=\"text-xs font-medium\">About</span>\n                </button>\n                \n                <button \n                  onClick={() => handleNav('contact')} \n                  className={`flex flex-col items-center gap-1 px-1 py-2 rounded-lg transition-all duration-200 ${\n                    currentView === 'contact' \n                      ? darkMode \n                        ? 'text-emerald-400' \n                        : 'text-emerald-600'\n                      : darkMode \n                        ? 'text-slate-400 hover:text-white' \n                        : 'text-slate-500 hover:text-slate-900'\n                  }`}\n                >\n                  <Phone size={16} />\n                  <span className=\"text-xs font-medium\">Contact</span>\n                </button>\n              </div>\n            </nav>\n          </div>\n        )}\n        \n        {/* Main Content */}\n        <main className={`flex-1 px-6 lg:px-12 pt-28 pb-32 relative z-10 ${\n          user ? 'max-w-none' : 'max-w-none'\n        }`}>\n          {currentView === 'home' && (\n            <div className=\"space-y-20\">\n              {/* Hero Section */}\n              <section className=\"text-center space-y-8\">\n                <div className=\"space-y-6\">\n                  <h1 className={`text-5xl lg:text-7xl font-black tracking-tight transition-all duration-700 ${\n                    darkMode ? 'text-white' : 'text-black'\n                  }`}>\n                    Premium\n                    <span className=\"block bg-gradient-to-r from-emerald-500 to-teal-600 bg-clip-text text-transparent\">\n                      Kitchen Essentials\n                    </span>\n                  </h1>\n                  <p className={`text-xl lg:text-2xl max-w-3xl mx-auto leading-relaxed ${\n                    darkMode ? 'text-white/70' : 'text-black/70'\n                  }`}>\n                    Discover handcrafted teak wood products and premium spices that transform your cooking experience\n                  </p>\n                </div>\n              </section>\n\n              {/* Products Section */}\n              <section className=\"space-y-12\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-4\">\n                    <h2 className={`text-4xl font-black transition-all duration-300 ${\n                      darkMode ? 'text-white' : 'text-black'\n                    }`}>\n                      Our Collection\n                    </h2>\n                    <div className={`flex items-center gap-4 px-6 py-3 rounded-2xl backdrop-blur-xl border transition-all duration-500 ${\n                      darkMode \n                        ? 'bg-white/5 border-white/10 text-white/60' \n                        : 'bg-black/5 border-black/10 text-black/60'\n                    }`}>\n                      <span className=\"text-lg font-semibold\">\n                        {Array.isArray(products) ? products.length : 0} Products Available\n                      </span>\n                    </div>\n                  </div>\n                </div>\n                \n                {/* Modern Product Grid */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 lg:gap-12\">\n                  {Array.isArray(products) && products.length > 0 ? (\n                    products.map(product => (\n                      <ProductCard\n                        key={product.id || product._id}\n                        product={product}\n                        user={user}\n                        wishlist={wishlist}\n                        cart={cart}\n                        onAddToCart={addToCart}\n                        onToggleWishlist={toggleWishlist}\n                        onUpdateQuantity={updateCartQuantity}\n                        onRemoveFromCart={removeFromCart}\n                        darkMode={darkMode}\n                      />\n                    ))\n                  ) : (\n                    <div className=\"col-span-full flex flex-col items-center justify-center py-16\">\n                      <div className=\"text-6xl mb-4\">ðŸ“¦</div>\n                      <h3 className={`text-lg font-semibold mb-2 transition-colors duration-300 ${\n                        darkMode ? 'text-white' : 'text-slate-900'\n                      }`}>No products available</h3>\n                      <p className={`transition-colors duration-300 ${\n                        darkMode ? 'text-slate-300' : 'text-slate-600'\n                      }`}>Check back later for new arrivals.</p>\n                    </div>\n                  )}\n                </div>\n              </section>\n            </div>\n          )}\n\n          {currentView === 'login' && (\n            <LoginForm\n              onLogin={handleLogin}\n              onSwitchToRegister={() => setCurrentView('register')}\n              loading={loading}\n              darkMode={darkMode}\n            />\n          )}\n          {currentView === 'register' && (\n            <RegisterForm\n              onRegister={handleRegister}\n              onSwitchToLogin={() => setCurrentView('login')}\n              loading={loading}\n              darkMode={darkMode}\n            />\n          )}\n          {currentView === 'cart' && (\n            <CartView\n              cart={cart}\n              user={user}\n              address={address}\n              onUpdateAddress={setAddress}\n              onPlaceOrder={placeOrder}\n              onNav={handleNav}\n              onUpdateQuantity={updateCartQuantity}\n              onRemoveFromCart={removeFromCart}\n              getCartTotal={getCartTotal}\n              products={products}\n              darkMode={darkMode}\n            />\n          )}\n          {currentView === 'orders' && user && <OrdersView orders={orders} products={products} darkMode={darkMode} />}\n          {currentView === 'wishlist' && user && (\n            <WishlistView\n              products={products}\n              wishlist={wishlist}\n              user={user}\n              onAddToCart={addToCart}\n              onToggleWishlist={toggleWishlist}\n              darkMode={darkMode}\n            />\n          )}\n          {currentView === 'profile' && user && <ProfileView user={user} darkMode={darkMode} />}\n          {currentView === 'about' && <AboutUs darkMode={darkMode} />}\n          {currentView === 'contact' && <ContactUs darkMode={darkMode} />}\n        </main>\n      </div>\n    </div>\n  );\n};\n\nexport default TeakSpiceStore;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}